# **Техническое задание на разработку системы «Smart Home Connect»**

**Версия 1.1 (с подсистемой эмуляции устройств)**
**Дата: 17.09.2025**

## 1. Общие сведения

*   **Наименование проекта:** Система удаленного управления и мониторинга IoT-устройствами «Smart Home Connect».
*   **Основание для разработки:** Учебный проект.
*   **Ключевая особенность:** Ввиду отсутствия физического оборудования, проект предусматривает создание и использование **программных эмуляторов устройств** для демонстрации и тестирования функциональности системы.

## 2. Термины и определения

*   **Система** — Программно-аппаратный комплекс «Smart Home Connect».
*   **Клиент** — Веб-приложение, предоставляющее пользовательский интерфейс.
*   **Сервер** — Бэкенд-часть приложения.
*   **Устройство** — **Виртуальное устройство (эмулятор)**, представляющее собой скрипт, имитирующий поведение реального IoT-устройства (например, умной розетки, датчика).
*   **Эмулятор устройства** — Программа, которая подключается к MQTT-брокеру, обменивается данными по заданным топикам и имитирует логику работы физического устройства.
*   **MQTT** — Message Queuing Telemetry Transport, протокол обмена сообщениями.
*   **JWT** — JSON Web Token, стандарт для токенов аутентификации.

## 3. Назначение и цели создания системы

### Назначение

Разработка программного обеспечения для централизованного управления и мониторинга **эмулируемых** IoT-устройств через веб-интерфейс.

### Цели проекта

*   Создать стабильно работающий прототип клиент-серверной системы.
*   Реализовать базовые функции управления **виртуальными устройствами**.
*   Разработать программные эмуляторы, имитирующие как минимум два типа устройств (например, "умная розетка" и "датчик температуры").
*   Получить опыт работы с полным технологическим стеком, включая протокол MQTT.

## 4. Требования к системе

### 4.1. Функциональные требования

#### 4.1.1. Подсистема аутентификации и авторизации
*   Регистрация новых пользователей (логин, email, пароль).
*   Вход в систему по логину и паролю.
*   Защита API с использованием JWT или OAuth2.

#### 4.1.2. Подсистема управления устройствами
*   Возможность добавления нового **виртуального устройства** в систему через интерфейс (пользователь задает ID и тип устройства).
*   Просмотр списка добавленных устройств и их текущего статуса (полученного от эмулятора).
*   Отправка команд на устройство (включение/выключение, установка целевого значения и т.д.).

#### 4.1.3. Подсистема логирования
*   Ведение журнала событий для каждого устройства (включено, выключено, изменение параметра, потеря связи).
*   Отображение журнала событий в интерфейсе пользователя.

#### 4.1.4. API для взаимодействия с устройствами
*   REST API для управления конфигурацией устройств в базе данных (CRUD).
*   Использование протокола MQTT для обмена командами и статусами между сервером и **эмуляторами устройств**.

#### 4.1.5. Подсистема эмуляции устройств
*   Необходимо разработать как минимум один скрипт-эмулятор на Python.
*   Эмулятор должен запускаться из командной строки с уникальным ID в качестве параметра.
*   Эмулятор должен уметь:
    *   Подключаться к MQTT-брокеру.
    *   Подписываться на топик для получения команд (например, `devices/ID_устройства/commands`).
    *   Публиковать сообщения о своем состоянии в топик статусов (например, `devices/ID_устройства/status`).
    *   Изменять свое внутреннее состояние в ответ на полученные команды.

### 4.2. Нефункциональные требования

*   **Производительность:** Время ответа серверного API не должно превышать 500 мс для 95% запросов.
*   **Надежность:** Система должна обеспечивать стабильную работу и корректно обрабатывать ошибки соединения с MQTT-брокером или БД.
*   **Безопасность:** Пароли пользователей должны храниться в хешированном виде. Для обмена данными между клиентом и сервером должен использоваться протокол HTTPS.
*   **Масштабируемость:** Архитектура должна позволять добавление новых типов эмулируемых устройств с минимальными изменениями в коде.

## 5. Требования к аппаратному и программному обеспечению

*   **Клиентская часть:**
    *   **ОС:** Windows, Linux, macOS.
    *   **Браузер:** Актуальные версии Chrome, Firefox, Safari, Edge.
    *   **Минимальные характеристики:** 4 ГБ ОЗУ, 2-ядерный процессор.

*   **Серверная часть:**
    *   **ОС:** Linux (рекомендуется).
    *   **Минимальные характеристики:** 8 ГБ ОЗУ, 4-ядерный процессор, 20 ГБ диска.

*   **Среда для запуска эмуляторов:**
    *   **ПО:** Python 3.9+, библиотека `paho-mqtt`.

## 6. Технические требования и архитектура

### Архитектура

```
+---------------------------+      (HTTP/REST API)      +---------------------------------+
| Веб-интерфейс (Клиент)    |<------------------------>|  Бэкенд-сервер (Django/FastAPI) |
+---------------------------+                           +---------------------------------+
              ^                                                         ^
              | (Отображение статусов)                                  | (MQTT: подписка на статусы)
              |                                                         |
              +---------------------------+-----------------------------+
                                          |
                                          | (MQTT: публикация команд)
                                          v
                                  +---------------+
                                  |  MQTT-брокер  |
                                  +---------------+
                                          ^
                                          | (Двусторонний обмен по MQTT)
                                          v
                +-----------------------------------------------------+
                | [Эмулятор 1] [Эмулятор 2] [Эмулятор ...]            |
                | (отдельные Python-скрипты)                          |
                +-----------------------------------------------------+

### Технологический стек

*   **Бэкенд:** Python (Django или FastAPI).
*   **База данных:** PostgreSQL (рекомендуется), SQLite (допустимо для разработки).
*   **Фронтенд:** React или Vue.
*   **Контейнеризация:** Docker, Docker Compose.
*   **CI/CD:** GitHub Actions.

## 7. Требования к интерфейсу

*   **Тип интерфейса:** Веб-приложение с адаптивной версткой.
*   **Основные экраны:**
    *   Страница входа и регистрации.
    *   Главная страница со списком устройств.
    *   Карточка устройства с детальной информацией, элементами управления и журналом событий.

## 8. Состав и содержание работ по созданию системы

*   **Этап 1: Проектирование (2 недели)**
    *   Разработка схемы БД.
    *   Проектирование архитектуры API (REST и структура MQTT-топиков).
    *   Создание прототипов интерфейса (wireframes).

*   **Этап 2: Разработка бэкенда и эмуляторов (4 недели)**
    *   Настройка проекта, реализация API.
    *   **Разработка и тестирование скриптов-эмуляторов устройств.**
    *   Интеграция бэкенда с MQTT-брокером.

*   **Этап 3: Разработка фронтенда (2 недели)**
    *   Верстка экранов и создание компонентов.
    *   Интеграция с бэкенд API.

*   **Этап 4: Тестирование и отладка (2 недели)**
    *   Комплексное тестирование всего цикла "интерфейс -> бэкенд -> MQTT -> эмулятор -> MQTT -> бэкенд -> интерфейс".
    *   Исправление ошибок и финализация.

## 9. Порядок контроля и приемки

*   **Контроль версий:** Ведение репозитория на GitHub.
*   **CI/CD:** Настройка GitHub Actions для автоматического запуска тестов.
*   **Критерии приемки:**
    *   Все функции, описанные в разделе 4.1, реализованы.
    *   Продемонстрирована стабильная работа системы с **несколькими одновременно запущенными эмуляторами**.
    *   Проект разворачивается и запускается одной командой `docker-compose up`.

## 10. Ресурсы и бюджет

*   **Бюджет:** 0 $ (учебный проект).
*   **Инструменты:** Только бесплатное и Open Source ПО (VS Code/PyCharm Community, GitHub, Docker, PostgreSQL).